{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":69,"index":69}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  class TransactionService {\n    static STORAGE_KEY_HISTORY = 'transaction_history';\n\n    /**\n     * Ajoute une transaction à l'historique\n     * @param {object} transaction \n     */\n    static async ajouterTransaction(transaction) {\n      try {\n        const history = await this.getHistory();\n        history.unshift(transaction); // Ajouter au début\n        // Limiter à 50 transactions locales\n        const limitedHistory = history.slice(0, 50);\n        await AsyncStorage.default.setItem(this.STORAGE_KEY_HISTORY, JSON.stringify(limitedHistory));\n      } catch (error) {\n        console.error('Erreur ajouterTransaction:', error);\n      }\n    }\n\n    /**\n     * Récupère l'historique des transactions\n     * @returns {Promise<Array>}\n     */\n    static async getHistory() {\n      try {\n        const json = await AsyncStorage.default.getItem(this.STORAGE_KEY_HISTORY);\n        return json ? JSON.parse(json) : [];\n      } catch (error) {\n        console.error('Erreur getHistory:', error);\n        return [];\n      }\n    }\n\n    /**\n     * Récupère toutes les transactions (alias pour getHistory)\n     */\n    static async getAllTransactions() {\n      return this.getHistory();\n    }\n\n    /**\n     * Récupère une transaction par son ID\n     * @param {string} id \n     */\n    static async getTransactionById(id) {\n      const history = await this.getHistory();\n      return history.find(t => t.id === id);\n    }\n\n    /**\n     * Récupère les transactions en attente de synchro\n     */\n    static async getPendingTransactions() {\n      const history = await this.getHistory();\n      return history.filter(t => !t.synchronise);\n    }\n\n    /**\n     * Marque des transactions comme synchronisées\n     * @param {Array<string>} ids \n     */\n    static async markAsSynced(ids) {\n      const history = await this.getHistory();\n      const updated = history.map(t => {\n        if (ids.includes(t.id)) {\n          return {\n            ...t,\n            synchronise: true,\n            statut: t.statut === 'EN_COURS' ? 'COMPLETEE' : t.statut\n          };\n        }\n        return t;\n      });\n      await AsyncStorage.default.setItem(this.STORAGE_KEY_HISTORY, JSON.stringify(updated));\n    }\n  }\n  var _default = TransactionService;\n});","lineCount":97,"map":[[12,2,76,0,"Object"],[12,8,76,0],[12,9,76,0,"defineProperty"],[12,23,76,0],[12,24,76,0,"exports"],[12,31,76,0],[13,4,76,0,"enumerable"],[13,14,76,0],[14,4,76,0,"get"],[14,7,76,0],[14,18,76,0,"get"],[14,19,76,0],[15,6,76,0],[15,13,76,0,"_default"],[15,21,76,0],[16,4,76,0],[17,2,76,0],[18,2,1,0],[18,6,1,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,1,0],[18,45,1,0,"require"],[18,52,1,0],[18,53,1,0,"_dependencyMap"],[18,67,1,0],[19,2,1,0],[19,6,1,0,"AsyncStorage"],[19,18,1,0],[19,21,1,0,"_interopDefault"],[19,36,1,0],[19,37,1,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,1,0],[20,2,3,0],[20,8,3,6,"TransactionService"],[20,26,3,24],[20,27,3,25],[21,4,4,4],[21,11,4,11,"STORAGE_KEY_HISTORY"],[21,30,4,30],[21,33,4,33],[21,54,4,54],[23,4,6,4],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,4,10,4],[27,17,10,17,"ajouterTransaction"],[27,35,10,35,"ajouterTransaction"],[27,36,10,36,"transaction"],[27,47,10,47],[27,49,10,49],[28,6,11,8],[28,10,11,12],[29,8,12,12],[29,14,12,18,"history"],[29,21,12,25],[29,24,12,28],[29,30,12,34],[29,34,12,38],[29,35,12,39,"getHistory"],[29,45,12,49],[29,46,12,50],[29,47,12,51],[30,8,13,12,"history"],[30,15,13,19],[30,16,13,20,"unshift"],[30,23,13,27],[30,24,13,28,"transaction"],[30,35,13,39],[30,36,13,40],[30,37,13,41],[30,38,13,42],[31,8,14,12],[32,8,15,12],[32,14,15,18,"limitedHistory"],[32,28,15,32],[32,31,15,35,"history"],[32,38,15,42],[32,39,15,43,"slice"],[32,44,15,48],[32,45,15,49],[32,46,15,50],[32,48,15,52],[32,50,15,54],[32,51,15,55],[33,8,16,12],[33,14,16,18,"AsyncStorage"],[33,26,16,30],[33,27,16,30,"default"],[33,34,16,30],[33,35,16,31,"setItem"],[33,42,16,38],[33,43,16,39],[33,47,16,43],[33,48,16,44,"STORAGE_KEY_HISTORY"],[33,67,16,63],[33,69,16,65,"JSON"],[33,73,16,69],[33,74,16,70,"stringify"],[33,83,16,79],[33,84,16,80,"limitedHistory"],[33,98,16,94],[33,99,16,95],[33,100,16,96],[34,6,17,8],[34,7,17,9],[34,8,17,10],[34,15,17,17,"error"],[34,20,17,22],[34,22,17,24],[35,8,18,12,"console"],[35,15,18,19],[35,16,18,20,"error"],[35,21,18,25],[35,22,18,26],[35,50,18,54],[35,52,18,56,"error"],[35,57,18,61],[35,58,18,62],[36,6,19,8],[37,4,20,4],[39,4,22,4],[40,0,23,0],[41,0,24,0],[42,0,25,0],[43,4,26,4],[43,17,26,17,"getHistory"],[43,27,26,27,"getHistory"],[43,28,26,27],[43,30,26,30],[44,6,27,8],[44,10,27,12],[45,8,28,12],[45,14,28,18,"json"],[45,18,28,22],[45,21,28,25],[45,27,28,31,"AsyncStorage"],[45,39,28,43],[45,40,28,43,"default"],[45,47,28,43],[45,48,28,44,"getItem"],[45,55,28,51],[45,56,28,52],[45,60,28,56],[45,61,28,57,"STORAGE_KEY_HISTORY"],[45,80,28,76],[45,81,28,77],[46,8,29,12],[46,15,29,19,"json"],[46,19,29,23],[46,22,29,26,"JSON"],[46,26,29,30],[46,27,29,31,"parse"],[46,32,29,36],[46,33,29,37,"json"],[46,37,29,41],[46,38,29,42],[46,41,29,45],[46,43,29,47],[47,6,30,8],[47,7,30,9],[47,8,30,10],[47,15,30,17,"error"],[47,20,30,22],[47,22,30,24],[48,8,31,12,"console"],[48,15,31,19],[48,16,31,20,"error"],[48,21,31,25],[48,22,31,26],[48,42,31,46],[48,44,31,48,"error"],[48,49,31,53],[48,50,31,54],[49,8,32,12],[49,15,32,19],[49,17,32,21],[50,6,33,8],[51,4,34,4],[53,4,36,4],[54,0,37,0],[55,0,38,0],[56,4,39,4],[56,17,39,17,"getAllTransactions"],[56,35,39,35,"getAllTransactions"],[56,36,39,35],[56,38,39,38],[57,6,40,8],[57,13,40,15],[57,17,40,19],[57,18,40,20,"getHistory"],[57,28,40,30],[57,29,40,31],[57,30,40,32],[58,4,41,4],[60,4,43,4],[61,0,44,0],[62,0,45,0],[63,0,46,0],[64,4,47,4],[64,17,47,17,"getTransactionById"],[64,35,47,35,"getTransactionById"],[64,36,47,36,"id"],[64,38,47,38],[64,40,47,40],[65,6,48,8],[65,12,48,14,"history"],[65,19,48,21],[65,22,48,24],[65,28,48,30],[65,32,48,34],[65,33,48,35,"getHistory"],[65,43,48,45],[65,44,48,46],[65,45,48,47],[66,6,49,8],[66,13,49,15,"history"],[66,20,49,22],[66,21,49,23,"find"],[66,25,49,27],[66,26,49,28,"t"],[66,27,49,29],[66,31,49,33,"t"],[66,32,49,34],[66,33,49,35,"id"],[66,35,49,37],[66,40,49,42,"id"],[66,42,49,44],[66,43,49,45],[67,4,50,4],[69,4,52,4],[70,0,53,0],[71,0,54,0],[72,4,55,4],[72,17,55,17,"getPendingTransactions"],[72,39,55,39,"getPendingTransactions"],[72,40,55,39],[72,42,55,42],[73,6,56,8],[73,12,56,14,"history"],[73,19,56,21],[73,22,56,24],[73,28,56,30],[73,32,56,34],[73,33,56,35,"getHistory"],[73,43,56,45],[73,44,56,46],[73,45,56,47],[74,6,57,8],[74,13,57,15,"history"],[74,20,57,22],[74,21,57,23,"filter"],[74,27,57,29],[74,28,57,30,"t"],[74,29,57,31],[74,33,57,35],[74,34,57,36,"t"],[74,35,57,37],[74,36,57,38,"synchronise"],[74,47,57,49],[74,48,57,50],[75,4,58,4],[77,4,60,4],[78,0,61,0],[79,0,62,0],[80,0,63,0],[81,4,64,4],[81,17,64,17,"markAsSynced"],[81,29,64,29,"markAsSynced"],[81,30,64,30,"ids"],[81,33,64,33],[81,35,64,35],[82,6,65,8],[82,12,65,14,"history"],[82,19,65,21],[82,22,65,24],[82,28,65,30],[82,32,65,34],[82,33,65,35,"getHistory"],[82,43,65,45],[82,44,65,46],[82,45,65,47],[83,6,66,8],[83,12,66,14,"updated"],[83,19,66,21],[83,22,66,24,"history"],[83,29,66,31],[83,30,66,32,"map"],[83,33,66,35],[83,34,66,36,"t"],[83,35,66,37],[83,39,66,41],[84,8,67,12],[84,12,67,16,"ids"],[84,15,67,19],[84,16,67,20,"includes"],[84,24,67,28],[84,25,67,29,"t"],[84,26,67,30],[84,27,67,31,"id"],[84,29,67,33],[84,30,67,34],[84,32,67,36],[85,10,68,16],[85,17,68,23],[86,12,68,25],[86,15,68,28,"t"],[86,16,68,29],[87,12,68,31,"synchronise"],[87,23,68,42],[87,25,68,44],[87,29,68,48],[88,12,68,50,"statut"],[88,18,68,56],[88,20,68,58,"t"],[88,21,68,59],[88,22,68,60,"statut"],[88,28,68,66],[88,33,68,71],[88,43,68,81],[88,46,68,84],[88,57,68,95],[88,60,68,98,"t"],[88,61,68,99],[88,62,68,100,"statut"],[89,10,68,107],[89,11,68,108],[90,8,69,12],[91,8,70,12],[91,15,70,19,"t"],[91,16,70,20],[92,6,71,8],[92,7,71,9],[92,8,71,10],[93,6,72,8],[93,12,72,14,"AsyncStorage"],[93,24,72,26],[93,25,72,26,"default"],[93,32,72,26],[93,33,72,27,"setItem"],[93,40,72,34],[93,41,72,35],[93,45,72,39],[93,46,72,40,"STORAGE_KEY_HISTORY"],[93,65,72,59],[93,67,72,61,"JSON"],[93,71,72,65],[93,72,72,66,"stringify"],[93,81,72,75],[93,82,72,76,"updated"],[93,89,72,83],[93,90,72,84],[93,91,72,85],[94,4,73,4],[95,2,74,0],[96,2,76,0],[96,6,76,0,"_default"],[96,14,76,0],[96,17,76,15,"TransactionService"],[96,35,76,33],[97,0,76,34],[97,3]],"functionMap":{"names":["<global>","TransactionService","ajouterTransaction","getHistory","getAllTransactions","getTransactionById","history.find$argument_0","getPendingTransactions","history.filter$argument_0","markAsSynced","history.map$argument_0"],"mappings":"AAA;ACE;ICO;KDU;IEM;KFQ;IGK;KHE;IIM;4BCE,gBD;KJC;IMK;8BCE,mBD;KNC;IQM;oCCE;SDK;KRE;CDC"},"hasCjsExports":false},"type":"js/module"}]}
{"dependencies":[{"name":"react-native-web/dist/exports/NativeModules","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"MRft9soElPgDBIQyAww27iefYeU=","exportNames":["*"],"imports":1}},{"name":"./MediaStream","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":46},"end":{"line":2,"column":40,"index":86}}],"key":"3Kf/979wvknqzqe4InQeiqZ8m2s=","exportNames":["*"],"imports":1}},{"name":"./MediaStreamError","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":87},"end":{"line":3,"column":50,"index":137}}],"key":"5hhVF4xhNA5cg/hI7Pd+vQPtSQY=","exportNames":["*"],"imports":1}},{"name":"./Permissions","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":138},"end":{"line":4,"column":40,"index":178}}],"key":"VwP+mbjkHwVEbn+H2lb3+ywyBqM=","exportNames":["*"],"imports":1}},{"name":"./RTCUtil","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":179},"end":{"line":5,"column":37,"index":216}}],"key":"CN8UyESr1mxcK8UZcasAG4s3jsI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return getUserMedia;\n    }\n  });\n  var _reactNativeWebDistExportsNativeModules = require(_dependencyMap[0], \"react-native-web/dist/exports/NativeModules\");\n  var NativeModules = _interopDefault(_reactNativeWebDistExportsNativeModules);\n  var _MediaStream = require(_dependencyMap[1], \"./MediaStream\");\n  var MediaStream = _interopDefault(_MediaStream);\n  var _MediaStreamError = require(_dependencyMap[2], \"./MediaStreamError\");\n  var MediaStreamError = _interopDefault(_MediaStreamError);\n  var _Permissions = require(_dependencyMap[3], \"./Permissions\");\n  var permissions = _interopDefault(_Permissions);\n  var _RTCUtil = require(_dependencyMap[4], \"./RTCUtil\");\n  var RTCUtil = _interopNamespace(_RTCUtil);\n  const {\n    WebRTCModule\n  } = NativeModules.default;\n  function getUserMedia() {\n    let constraints = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // According to\n    // https://www.w3.org/TR/mediacapture-streams/#dom-mediadevices-getusermedia,\n    // the constraints argument is a dictionary of type MediaStreamConstraints.\n    if (typeof constraints !== 'object') {\n      return Promise.reject(new TypeError('constraints is not a dictionary'));\n    }\n    if ((typeof constraints.audio === 'undefined' || !constraints.audio) && (typeof constraints.video === 'undefined' || !constraints.video)) {\n      return Promise.reject(new TypeError('audio and/or video is required'));\n    }\n\n    // Normalize constraints.\n    constraints = RTCUtil.normalizeConstraints(constraints);\n\n    // Request required permissions\n    const reqPermissions = [];\n    if (constraints.audio) {\n      reqPermissions.push(permissions.default.request({\n        name: 'microphone'\n      }));\n    } else {\n      reqPermissions.push(Promise.resolve(false));\n    }\n    if (constraints.video) {\n      reqPermissions.push(permissions.default.request({\n        name: 'camera'\n      }));\n    } else {\n      reqPermissions.push(Promise.resolve(false));\n    }\n    return new Promise((resolve, reject) => {\n      Promise.all(reqPermissions).then(results => {\n        const [audioPerm, videoPerm] = results;\n\n        // Check permission results and remove unneeded permissions.\n\n        if (!audioPerm && !videoPerm) {\n          // https://www.w3.org/TR/mediacapture-streams/#dom-mediadevices-getusermedia\n          // step 4\n          const error = {\n            message: 'Permission denied.',\n            name: 'SecurityError'\n          };\n          reject(new MediaStreamError.default(error));\n          return;\n        }\n        audioPerm || delete constraints.audio;\n        videoPerm || delete constraints.video;\n        const success = (id, tracks) => {\n          // Store initial constraints.\n          for (const trackInfo of tracks) {\n            const c = constraints[trackInfo.kind];\n            if (typeof c === 'object') {\n              trackInfo.constraints = RTCUtil.deepClone(c);\n            }\n          }\n          const info = {\n            streamId: id,\n            streamReactTag: id,\n            tracks\n          };\n          resolve(new MediaStream.default(info));\n        };\n        const failure = (type, message) => {\n          let error;\n          switch (type) {\n            case 'TypeError':\n              error = new TypeError(message);\n              break;\n          }\n          if (!error) {\n            error = new MediaStreamError.default({\n              message,\n              name: type\n            });\n          }\n          reject(error);\n        };\n        WebRTCModule.getUserMedia(constraints, success, failure);\n      });\n    });\n  }\n});","lineCount":129,"map":[[27,2,9,15,"Object"],[27,8,9,15],[27,9,9,15,"defineProperty"],[27,23,9,15],[27,24,9,15,"exports"],[27,31,9,15],[28,4,9,15,"enumerable"],[28,14,9,15],[29,4,9,15,"get"],[29,7,9,15],[29,18,9,15,"get"],[29,19,9,15],[30,6,9,15],[30,13,9,15,"getUserMedia"],[30,25,9,15],[31,4,9,15],[32,2,9,15],[33,2,91,1],[33,6,91,1,"_reactNativeWebDistExportsNativeModules"],[33,45,91,1],[33,48,91,1,"require"],[33,55,91,1],[33,56,91,1,"_dependencyMap"],[33,70,91,1],[34,2,91,1],[34,6,91,1,"NativeModules"],[34,19,91,1],[34,22,91,1,"_interopDefault"],[34,37,91,1],[34,38,91,1,"_reactNativeWebDistExportsNativeModules"],[34,77,91,1],[35,2,2,0],[35,6,2,0,"_MediaStream"],[35,18,2,0],[35,21,2,0,"require"],[35,28,2,0],[35,29,2,0,"_dependencyMap"],[35,43,2,0],[36,2,2,0],[36,6,2,0,"MediaStream"],[36,17,2,0],[36,20,2,0,"_interopDefault"],[36,35,2,0],[36,36,2,0,"_MediaStream"],[36,48,2,0],[37,2,3,0],[37,6,3,0,"_MediaStreamError"],[37,23,3,0],[37,26,3,0,"require"],[37,33,3,0],[37,34,3,0,"_dependencyMap"],[37,48,3,0],[38,2,3,0],[38,6,3,0,"MediaStreamError"],[38,22,3,0],[38,25,3,0,"_interopDefault"],[38,40,3,0],[38,41,3,0,"_MediaStreamError"],[38,58,3,0],[39,2,4,0],[39,6,4,0,"_Permissions"],[39,18,4,0],[39,21,4,0,"require"],[39,28,4,0],[39,29,4,0,"_dependencyMap"],[39,43,4,0],[40,2,4,0],[40,6,4,0,"permissions"],[40,17,4,0],[40,20,4,0,"_interopDefault"],[40,35,4,0],[40,36,4,0,"_Permissions"],[40,48,4,0],[41,2,5,0],[41,6,5,0,"_RTCUtil"],[41,14,5,0],[41,17,5,0,"require"],[41,24,5,0],[41,25,5,0,"_dependencyMap"],[41,39,5,0],[42,2,5,0],[42,6,5,0,"RTCUtil"],[42,13,5,0],[42,16,5,0,"_interopNamespace"],[42,33,5,0],[42,34,5,0,"_RTCUtil"],[42,42,5,0],[43,2,6,0],[43,8,6,6],[44,4,7,2,"WebRTCModule"],[45,2,8,0],[45,3,8,1],[45,6,8,4,"NativeModules"],[45,19,8,17],[45,20,8,17,"default"],[45,27,8,17],[46,2,9,15],[46,11,9,24,"getUserMedia"],[46,23,9,36,"getUserMedia"],[46,24,9,36],[46,26,9,39],[47,4,10,2],[47,8,10,6,"constraints"],[47,19,10,17],[47,22,10,20,"arguments"],[47,31,10,29],[47,32,10,30,"length"],[47,38,10,36],[47,41,10,39],[47,42,10,40],[47,46,10,44,"arguments"],[47,55,10,53],[47,56,10,54],[47,57,10,55],[47,58,10,56],[47,63,10,61,"undefined"],[47,72,10,70],[47,75,10,73,"arguments"],[47,84,10,82],[47,85,10,83],[47,86,10,84],[47,87,10,85],[47,90,10,88],[47,91,10,89],[47,92,10,90],[48,4,11,2],[49,4,12,2],[50,4,13,2],[51,4,14,2],[51,8,14,6],[51,15,14,13,"constraints"],[51,26,14,24],[51,31,14,29],[51,39,14,37],[51,41,14,39],[52,6,15,4],[52,13,15,11,"Promise"],[52,20,15,18],[52,21,15,19,"reject"],[52,27,15,25],[52,28,15,26],[52,32,15,30,"TypeError"],[52,41,15,39],[52,42,15,40],[52,75,15,73],[52,76,15,74],[52,77,15,75],[53,4,16,2],[54,4,17,2],[54,8,17,6],[54,9,17,7],[54,16,17,14,"constraints"],[54,27,17,25],[54,28,17,26,"audio"],[54,33,17,31],[54,38,17,36],[54,49,17,47],[54,53,17,51],[54,54,17,52,"constraints"],[54,65,17,63],[54,66,17,64,"audio"],[54,71,17,69],[54,77,17,75],[54,84,17,82,"constraints"],[54,95,17,93],[54,96,17,94,"video"],[54,101,17,99],[54,106,17,104],[54,117,17,115],[54,121,17,119],[54,122,17,120,"constraints"],[54,133,17,131],[54,134,17,132,"video"],[54,139,17,137],[54,140,17,138],[54,142,17,140],[55,6,18,4],[55,13,18,11,"Promise"],[55,20,18,18],[55,21,18,19,"reject"],[55,27,18,25],[55,28,18,26],[55,32,18,30,"TypeError"],[55,41,18,39],[55,42,18,40],[55,74,18,72],[55,75,18,73],[55,76,18,74],[56,4,19,2],[58,4,21,2],[59,4,22,2,"constraints"],[59,15,22,13],[59,18,22,16,"RTCUtil"],[59,25,22,23],[59,26,22,24,"normalizeConstraints"],[59,46,22,44],[59,47,22,45,"constraints"],[59,58,22,56],[59,59,22,57],[61,4,24,2],[62,4,25,2],[62,10,25,8,"reqPermissions"],[62,24,25,22],[62,27,25,25],[62,29,25,27],[63,4,26,2],[63,8,26,6,"constraints"],[63,19,26,17],[63,20,26,18,"audio"],[63,25,26,23],[63,27,26,25],[64,6,27,4,"reqPermissions"],[64,20,27,18],[64,21,27,19,"push"],[64,25,27,23],[64,26,27,24,"permissions"],[64,37,27,35],[64,38,27,35,"default"],[64,45,27,35],[64,46,27,36,"request"],[64,53,27,43],[64,54,27,44],[65,8,28,6,"name"],[65,12,28,10],[65,14,28,12],[66,6,29,4],[66,7,29,5],[66,8,29,6],[66,9,29,7],[67,4,30,2],[67,5,30,3],[67,11,30,9],[68,6,31,4,"reqPermissions"],[68,20,31,18],[68,21,31,19,"push"],[68,25,31,23],[68,26,31,24,"Promise"],[68,33,31,31],[68,34,31,32,"resolve"],[68,41,31,39],[68,42,31,40],[68,47,31,45],[68,48,31,46],[68,49,31,47],[69,4,32,2],[70,4,33,2],[70,8,33,6,"constraints"],[70,19,33,17],[70,20,33,18,"video"],[70,25,33,23],[70,27,33,25],[71,6,34,4,"reqPermissions"],[71,20,34,18],[71,21,34,19,"push"],[71,25,34,23],[71,26,34,24,"permissions"],[71,37,34,35],[71,38,34,35,"default"],[71,45,34,35],[71,46,34,36,"request"],[71,53,34,43],[71,54,34,44],[72,8,35,6,"name"],[72,12,35,10],[72,14,35,12],[73,6,36,4],[73,7,36,5],[73,8,36,6],[73,9,36,7],[74,4,37,2],[74,5,37,3],[74,11,37,9],[75,6,38,4,"reqPermissions"],[75,20,38,18],[75,21,38,19,"push"],[75,25,38,23],[75,26,38,24,"Promise"],[75,33,38,31],[75,34,38,32,"resolve"],[75,41,38,39],[75,42,38,40],[75,47,38,45],[75,48,38,46],[75,49,38,47],[76,4,39,2],[77,4,40,2],[77,11,40,9],[77,15,40,13,"Promise"],[77,22,40,20],[77,23,40,21],[77,24,40,22,"resolve"],[77,31,40,29],[77,33,40,31,"reject"],[77,39,40,37],[77,44,40,42],[78,6,41,4,"Promise"],[78,13,41,11],[78,14,41,12,"all"],[78,17,41,15],[78,18,41,16,"reqPermissions"],[78,32,41,30],[78,33,41,31],[78,34,41,32,"then"],[78,38,41,36],[78,39,41,37,"results"],[78,46,41,44],[78,50,41,48],[79,8,42,6],[79,14,42,12],[79,15,42,13,"audioPerm"],[79,24,42,22],[79,26,42,24,"videoPerm"],[79,35,42,33],[79,36,42,34],[79,39,42,37,"results"],[79,46,42,44],[81,8,44,6],[83,8,46,6],[83,12,46,10],[83,13,46,11,"audioPerm"],[83,22,46,20],[83,26,46,24],[83,27,46,25,"videoPerm"],[83,36,46,34],[83,38,46,36],[84,10,47,8],[85,10,48,8],[86,10,49,8],[86,16,49,14,"error"],[86,21,49,19],[86,24,49,22],[87,12,50,10,"message"],[87,19,50,17],[87,21,50,19],[87,41,50,39],[88,12,51,10,"name"],[88,16,51,14],[88,18,51,16],[89,10,52,8],[89,11,52,9],[90,10,53,8,"reject"],[90,16,53,14],[90,17,53,15],[90,21,53,19,"MediaStreamError"],[90,37,53,35],[90,38,53,35,"default"],[90,45,53,35],[90,46,53,36,"error"],[90,51,53,41],[90,52,53,42],[90,53,53,43],[91,10,54,8],[92,8,55,6],[93,8,56,6,"audioPerm"],[93,17,56,15],[93,21,56,19],[93,28,56,26,"constraints"],[93,39,56,37],[93,40,56,38,"audio"],[93,45,56,43],[94,8,57,6,"videoPerm"],[94,17,57,15],[94,21,57,19],[94,28,57,26,"constraints"],[94,39,57,37],[94,40,57,38,"video"],[94,45,57,43],[95,8,58,6],[95,14,58,12,"success"],[95,21,58,19],[95,24,58,22,"success"],[95,25,58,23,"id"],[95,27,58,25],[95,29,58,27,"tracks"],[95,35,58,33],[95,40,58,38],[96,10,59,8],[97,10,60,8],[97,15,60,13],[97,21,60,19,"trackInfo"],[97,30,60,28],[97,34,60,32,"tracks"],[97,40,60,38],[97,42,60,40],[98,12,61,10],[98,18,61,16,"c"],[98,19,61,17],[98,22,61,20,"constraints"],[98,33,61,31],[98,34,61,32,"trackInfo"],[98,43,61,41],[98,44,61,42,"kind"],[98,48,61,46],[98,49,61,47],[99,12,62,10],[99,16,62,14],[99,23,62,21,"c"],[99,24,62,22],[99,29,62,27],[99,37,62,35],[99,39,62,37],[100,14,63,12,"trackInfo"],[100,23,63,21],[100,24,63,22,"constraints"],[100,35,63,33],[100,38,63,36,"RTCUtil"],[100,45,63,43],[100,46,63,44,"deepClone"],[100,55,63,53],[100,56,63,54,"c"],[100,57,63,55],[100,58,63,56],[101,12,64,10],[102,10,65,8],[103,10,66,8],[103,16,66,14,"info"],[103,20,66,18],[103,23,66,21],[104,12,67,10,"streamId"],[104,20,67,18],[104,22,67,20,"id"],[104,24,67,22],[105,12,68,10,"streamReactTag"],[105,26,68,24],[105,28,68,26,"id"],[105,30,68,28],[106,12,69,10,"tracks"],[107,10,70,8],[107,11,70,9],[108,10,71,8,"resolve"],[108,17,71,15],[108,18,71,16],[108,22,71,20,"MediaStream"],[108,33,71,31],[108,34,71,31,"default"],[108,41,71,31],[108,42,71,32,"info"],[108,46,71,36],[108,47,71,37],[108,48,71,38],[109,8,72,6],[109,9,72,7],[110,8,73,6],[110,14,73,12,"failure"],[110,21,73,19],[110,24,73,22,"failure"],[110,25,73,23,"type"],[110,29,73,27],[110,31,73,29,"message"],[110,38,73,36],[110,43,73,41],[111,10,74,8],[111,14,74,12,"error"],[111,19,74,17],[112,10,75,8],[112,18,75,16,"type"],[112,22,75,20],[113,12,76,10],[113,17,76,15],[113,28,76,26],[114,14,77,12,"error"],[114,19,77,17],[114,22,77,20],[114,26,77,24,"TypeError"],[114,35,77,33],[114,36,77,34,"message"],[114,43,77,41],[114,44,77,42],[115,14,78,12],[116,10,79,8],[117,10,80,8],[117,14,80,12],[117,15,80,13,"error"],[117,20,80,18],[117,22,80,20],[118,12,81,10,"error"],[118,17,81,15],[118,20,81,18],[118,24,81,22,"MediaStreamError"],[118,40,81,38],[118,41,81,38,"default"],[118,48,81,38],[118,49,81,39],[119,14,82,12,"message"],[119,21,82,19],[120,14,83,12,"name"],[120,18,83,16],[120,20,83,18,"type"],[121,12,84,10],[121,13,84,11],[121,14,84,12],[122,10,85,8],[123,10,86,8,"reject"],[123,16,86,14],[123,17,86,15,"error"],[123,22,86,20],[123,23,86,21],[124,8,87,6],[124,9,87,7],[125,8,88,6,"WebRTCModule"],[125,20,88,18],[125,21,88,19,"getUserMedia"],[125,33,88,31],[125,34,88,32,"constraints"],[125,45,88,43],[125,47,88,45,"success"],[125,54,88,52],[125,56,88,54,"failure"],[125,63,88,61],[125,64,88,62],[126,6,89,4],[126,7,89,5],[126,8,89,6],[127,4,90,2],[127,5,90,3],[127,6,90,4],[128,2,91,0],[129,0,91,1],[129,3]],"functionMap":{"names":["<global>","getUserMedia","Promise$argument_0","Promise.all.then$argument_0","success","failure"],"mappings":"AAA;eCQ;qBC+B;qCCC;sBCiB;ODc;sBEC;OFc;KDE;GDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}